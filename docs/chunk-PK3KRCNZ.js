import{b as h,c}from"./chunk-W33Z2I5C.js";import{a as y}from"./chunk-MMPSNAPN.js";import{j as r,l as i,n as a,o as s,q as g}from"./chunk-FT3LMQJV.js";import{a as m,b as w,i as l,pg as u}from"./chunk-PR3HXOEE.js";var _=new r({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),v=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,A=[a.fromTemplate(v),i.fromTemplate("{question}")],b=s.fromMessages(A),T=new h(_,[[c,b]]);function C(d,e={}){let{prompt:t=T.getPrompt(d),verbose:n}=e,o=new g({prompt:t,llm:d,verbose:n});return new y({llmChain:o,verbose:n})}var X=class P extends u{static lc_name(){return"VectorDBQAChain"}k=4;inputKey="query";get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}vectorstore;combineDocumentsChain;returnSourceDocuments=!1;constructor(e){super(e),this.vectorstore=e.vectorstore,this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.k=e.k??this.k,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}_call(e,t){return l(this,null,function*(){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);let n=e[this.inputKey],o=yield this.vectorstore.similaritySearch(n,this.k,e.filter,t?.getChild("vectorstore")),p={question:n,input_documents:o},f=yield this.combineDocumentsChain.call(p,t?.getChild("combine_documents"));return this.returnSourceDocuments?w(m({},f),{sourceDocuments:o}):f})}_chainType(){return"vector_db_qa"}static deserialize(e,t){return l(this,null,function*(){if(!("vectorstore"in t))throw new Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");let{vectorstore:n}=t;if(!e.combine_documents_chain)throw new Error("VectorDBQAChain must have combine_documents_chain in serialized data");return new P({combineDocumentsChain:yield u.deserialize(e.combine_documents_chain),k:e.k,vectorstore:n})})}serialize(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),k:this.k}}static fromLLM(e,t,n){let o=C(e);return new this(m({vectorstore:t,combineDocumentsChain:o},n))}};export{X as VectorDBQAChain};
