import{Nd as d,Vd as y,a as p,b as c,i as n}from"./chunk-PR3HXOEE.js";var h=class{getPromptAsync(t,e){return n(this,null,function*(){return this.getPrompt(t).partial(e?.partialVariables??{})})}},f=class extends h{defaultPrompt;conditionals;constructor(t,e=[]){super(),this.defaultPrompt=t,this.conditionals=e}getPrompt(t){for(let[e,s]of this.conditionals)if(e(t))return s;return this.defaultPrompt}};function v(t){return t._modelType()==="base_llm"}function E(t){return t._modelType()==="base_chat_model"}var m=class extends y{lc_namespace=["langchain_core","example_selectors","base"]};function L(t){return t.split(/\n| /).length}var P=class K extends m{examples=[];examplePrompt;getTextLength=L;maxLength=2048;exampleTextLengths=[];constructor(e){super(e),this.examplePrompt=e.examplePrompt,this.maxLength=e.maxLength??2048,this.getTextLength=e.getTextLength??L}addExample(e){return n(this,null,function*(){this.examples.push(e);let s=yield this.examplePrompt.format(e);this.exampleTextLengths.push(this.getTextLength(s))})}calculateExampleTextLengths(e,s){return n(this,null,function*(){if(e.length>0)return e;let{examples:o,examplePrompt:r}=s;return(yield Promise.all(o.map(a=>r.format(a)))).map(a=>this.getTextLength(a))})}selectExamples(e){return n(this,null,function*(){let s=Object.values(e).join(" "),o=this.maxLength-this.getTextLength(s),r=0,i=[];for(;o>0&&r<this.examples.length;){let a=o-this.exampleTextLengths[r];if(a<0)break;i.push(this.examples[r]),o=a,r+=1}return i})}static fromExamples(e,s){return n(this,null,function*(){let o=new K(s);return yield Promise.all(e.map(r=>o.addExample(r))),o})}};var w=class{pageContent;metadata;id;constructor(t){this.pageContent=t.pageContent!==void 0?t.pageContent.toString():"",this.metadata=t.metadata??{},this.id=t.id}};function u(t){return Object.keys(t).sort().map(e=>t[e])}var B=class T extends m{vectorStoreRetriever;exampleKeys;inputKeys;constructor(e){if(super(e),this.exampleKeys=e.exampleKeys,this.inputKeys=e.inputKeys,e.vectorStore!==void 0)this.vectorStoreRetriever=e.vectorStore.asRetriever({k:e.k??4,filter:e.filter});else if(e.vectorStoreRetriever)this.vectorStoreRetriever=e.vectorStoreRetriever;else throw new Error('You must specify one of "vectorStore" and "vectorStoreRetriever".')}addExample(e){return n(this,null,function*(){let s=this.inputKeys??Object.keys(e),o=u(s.reduce((r,i)=>c(p({},r),{[i]:e[i]}),{})).join(" ");yield this.vectorStoreRetriever.addDocuments([new w({pageContent:o,metadata:e})])})}selectExamples(e){return n(this,null,function*(){let s=this.inputKeys??Object.keys(e),o=u(s.reduce((a,x)=>c(p({},a),{[x]:e[x]}),{})).join(" "),i=(yield this.vectorStoreRetriever.invoke(o)).map(a=>a.metadata);return this.exampleKeys?i.map(a=>this.exampleKeys.reduce((x,l)=>c(p({},x),{[l]:a[l]}),{})):i})}static fromExamples(i,a,x){return n(this,arguments,function*(e,s,o,r={}){let l=r.inputKeys??null,C=e.map(g=>u(l?l.reduce((b,S)=>c(p({},b),{[S]:g[S]}),{}):g).join(" ")),_=yield o.fromTexts(C,e,s,r);return new T({vectorStore:_,k:r.k??4,exampleKeys:r.exampleKeys,inputKeys:r.inputKeys})})}};var R={};d(R,{BaseExampleSelector:()=>m,BasePromptSelector:()=>h,ConditionalPromptSelector:()=>f,LengthBasedExampleSelector:()=>P,SemanticSimilarityExampleSelector:()=>B,isChatModel:()=>E,isLLM:()=>v});export{w as a,f as b,E as c,R as d};
